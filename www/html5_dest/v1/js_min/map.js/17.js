define(function(require,exports){require("zepto-ext");var city,province,tpl=require("./widget/tpl-engine"),map=new BMap.Map("mdd-map");map.centerAndZoom(new BMap.Point(116.404,39.915),11),map.addControl(new BMap.ZoomControl);var local=new BMap.LocalSearch(map,{onSearchComplete:function(results){city=results.city,province=results.province,$("#location-list").html(tpl.parse("location-list-tpl",{data:results._pois}))}});window.setMapLocation=function(address){local.search(address),$(".map-search-input").val(address)},$(".map-search-input").bind("keyup",function(event){"13"==event.keyCode&&local.search($(this).val())}),$(".map-search-btn").on("click",function(){local.search($(".map-search-input").val())}),map.addEventListener("click",function(e){}),$("#location-list").on("click",".location-list-item",function(){var title=$(this).find(".location-list-item-title").text(),param={province:province,city:city,address:title,lat:$(this).data("lat"),lng:$(this).data("lng")};$(".js-set-address",parent.document).text(title),$(parent.setHomeLocation(param)),window.parent.history.back()})});