!function(){function _createQueueReadyIframe(doc){messagingIframe=doc.createElement("iframe"),messagingIframe.style.display="none",doc.documentElement.appendChild(messagingIframe)}function isAndroid(){var ua=navigator.userAgent.toLowerCase(),isA=ua.indexOf("android")>-1;return isA?!0:!1}function isIphone(){var ua=navigator.userAgent.toLowerCase(),isIph=ua.indexOf("iphone")>-1;return isIph?!0:!1}function init(messageHandler){if(WebViewJavascriptBridge._messageHandler)throw new Error("WebViewJavascriptBridge.init called twice");WebViewJavascriptBridge._messageHandler=messageHandler;var receivedMessages=receiveMessageQueue;receiveMessageQueue=null;for(var i=0;i<receivedMessages.length;i++)_dispatchMessageFromNative(receivedMessages[i])}function send(data,responseCallback){_doSend({data:data},responseCallback)}function defaultHandler(handler){defaultHandler=handler}function registerHandler(handlerName,handler){messageHandlers[handlerName]=handler}function callHandler(handlerName,data,responseCallback){_doSend({handlerName:handlerName,data:data},responseCallback)}function _doSend(message,responseCallback){if(responseCallback){var callbackId="cb_"+uniqueId++ +"_"+(new Date).getTime();responseCallbacks[callbackId]=responseCallback,message.callbackId=callbackId}sendMessageQueue.push(message),messagingIframe.src=CUSTOM_PROTOCOL_SCHEME+"://"+QUEUE_HAS_MESSAGE}function _fetchQueue(){var messageQueueString=JSON.stringify(sendMessageQueue);return sendMessageQueue=[],isIphone()?messageQueueString:void(isAndroid()&&(messagingIframe.src=CUSTOM_PROTOCOL_SCHEME+"://return/_fetchQueue@"+messageQueueString))}function _dispatchMessageFromNative(messageJSON){setTimeout(function(){var responseCallback,message=JSON.parse(messageJSON);if(message.responseId){if(responseCallback=responseCallbacks[message.responseId],!responseCallback)return;responseCallback(message.responseData),delete responseCallbacks[message.responseId]}else{if(message.callbackId){var callbackResponseId=message.callbackId;responseCallback=function(responseData){_doSend({responseId:callbackResponseId,responseData:responseData})}}var handler=WebViewJavascriptBridge._messageHandler;handler=message.handlerName?messageHandlers[message.handlerName]:defaultHandler;try{handler(message.data,responseCallback)}catch(exception){"undefined"!=typeof console&&console.log("WebViewJavascriptBridge: WARNING: javascript handler threw.",message,exception)}}})}function _handleMessageFromNative(messageJSON){receiveMessageQueue?receiveMessageQueue.push(messageJSON):_dispatchMessageFromNative(messageJSON)}if(!window.WebViewJavascriptBridge){var messagingIframe,defaultHandler,sendMessageQueue=[],receiveMessageQueue=[],messageHandlers={},CUSTOM_PROTOCOL_SCHEME="miduoduo",QUEUE_HAS_MESSAGE="__QUEUE_MESSAGE__/",responseCallbacks={},uniqueId=1,WebViewJavascriptBridge=window.WebViewJavascriptBridge={init:init,send:send,defaultHandler:defaultHandler,registerHandler:registerHandler,callHandler:callHandler,_fetchQueue:_fetchQueue,_handleMessageFromNative:_handleMessageFromNative},doc=document;_createQueueReadyIframe(doc),init(function(data,responseCallback){responseCallback()});var readyEvent=doc.createEvent("Events");readyEvent.initEvent("WebViewJavascriptBridgeReady"),readyEvent.bridge=WebViewJavascriptBridge,doc.dispatchEvent(readyEvent)}}();